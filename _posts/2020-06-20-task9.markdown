---
layout: post
title:  "Task 9: NAT"
date:   2020-06-20 12:00:00 +0800
categories: [router, nat]
---

ğŸ¦ŒåŒ—é¹¿è€å¸ˆè¿™æ¬¡è®©æˆ‘ä»¬åš NATï¼Œå®¶ç”¨çš„è·¯ç”±ç‰¹æ€§åˆ°è¿™é‡Œå°±é…ç½®å…¨äº†ã€‚

Nat æœ‰å‡ ç§æ–¹å¼ï¼Œä½†å‡ ç§æ–¹å¼çš„åŸç†æ˜¯ç›¸é€šçš„ã€‚

- Basic NAT ç»´æŠ¤ä¸€ä¸ªå…¬ç½‘çš„åœ°å€æ± ç”¨äº NATï¼Œä¸åˆ©ç”¨ç«¯å£ä¿¡æ¯ã€‚åªæœ‰è¿™ç§æ–¹å¼æ‰èƒ½æ”¯æŒæ‰€æœ‰çš„ IP åè®®ã€‚
- NAPT ç»´æŠ¤ä¸€ä¸ªå…¬ç½‘çš„åœ°å€æ± ï¼Œå¹¶ä¸”åˆ©ç”¨ç«¯å£å¤ç”¨åœ°å€è¿›è¡Œ NATã€‚å› ä¸ºåˆ©ç”¨äº†ç«¯å£ï¼Œæ‰€ä»¥åªæ”¯æŒ TCPã€UDP å’Œ ICMPã€‚
- Easy IP ç›´æ¥åˆ©ç”¨è·¯ç”±å™¨æ¥å£ä¸‹çš„å…¬ç½‘åœ°å€ï¼Œå€ŸåŠ©ç«¯å£è¿›è¡Œ NATã€‚

![ç½‘ç»œæ‹“æ‰‘](https://lightyears1998.github.io/gzhu-networking-course-record/images/task9.png)

é…ç½®çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š

``` shell
# R1
sys
sysname R1
int ge 0/0
ip addr 10.0.0.2 24
int ge 0/1
ip addr 10.0.1.1 24
ip route-static 0.0.0.0 0 10.0.1.2

# NAT
sys
sysname NAT
int ge 0/1
ip addr 10.0.1.2 24
int ge 0/0
ip addr 200.10.10.1 24
ip route-static 10.0.0.0 24 10.0.1.1
ip route-static 200.10.20.2 24 200.10.10.2
acl basic 2000
rule 0 permit source 10.0.0.0 0.0.0.255

# R2
sys
sysname R2
int ge 0/0
ip addr 200.10.10.2 24
int ge 0/1
ip addr 200.10.20.1 24
ip route-static 100.10.10.1 24 200.10.10.1

# R3
sys
sysname R3
int ge 0/1
ip addr 200.10.20.2 24
ip route-static 100.10.10.1 24 200.10.20.1
ip route-static 200.10.10.1 24 200.10.20.1
```

NAPT çš„é…ç½®ï¼š

``` shell
[åœ¨ NAT è·¯ç”±å™¨ä¸Š]
nat address-group 1
address 100.10.10.1 100.10.10.10
int ge 0/0
nat outbound 2000 address-group 1
[Ctrl + Z]
terminal monitor
terminal debugging
debugging nat packet
[åœ¨ PC ä¸Š ping R3]
```

Easy IP çš„é…ç½®ï¼š

``` shell
[åœ¨ NAT è·¯ç”±å™¨ä¸Š]
sys
int ge 0/0
undo nat outbound 2000
undo nat address-group 1
int ge 0/0
nat outbound 2000
[Ctrl + Z]
terminal monitor
terminal debugging
debugging nat packet
[åœ¨ PC ä¸Š ping R3]
```
