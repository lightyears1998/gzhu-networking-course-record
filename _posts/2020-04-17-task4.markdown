---
layout: post
title:  "Task 4: VLAN and Trunk"
date:   2020-04-17 14:00:00 +0800
categories: [switch, vlan, trunk, hybrid]
---

æœ¬å‘¨çš„é‡ç‚¹è¿˜æ˜¯äº¤æ¢æœºï¼ŒğŸ¦ŒåŒ—é¹¿è€å¸ˆè®©æˆ‘ä»¬åšå¤æ‚ä¸€ç‚¹çš„æ‹“æ‰‘ã€‚

## Trunké“¾è·¯ï¼šè·¨äº¤æ¢æœºçš„VLANé€šä¿¡

![ç½‘ç»œæ‹“æ‰‘](https://lightyears1998.github.io/gzhu-networking-course-record/images/task4-1.png)

äº¤æ¢æœºä¹‹é—´çš„é“¾è·¯ç±»å‹æ˜¯Trunkç±»å‹ã€‚ä¸ºäº†å®ç°è·¨äº¤æ¢æœºçš„VLANé€šä¿¡ï¼Œé™¤äº†é…ç½®å¥½PCçš„é™æ€IPåœ°å€ä¹‹å¤–ï¼Œè¿˜éœ€è¦åœ¨äº¤æ¢æœºä¸Šåšå‡ºå¦‚ä¸‹è®¾å®šã€‚

```sh
# SW1
system-view
vlan 10
port ge 1/0/1
vlan 20
port ge 1/0/2
int ge 1/0/23
port link-type trunk
port trunk pvid vlan 10
port trunk permit vlan all
```

SW2çš„è®¾ç½®ä¸SW1æ˜¯ä¸€æ ·çš„ã€‚å¯ä»¥é€šè¿‡åœ¨äº¤æ¢æœºä¸Š`display`æ¥éªŒè¯å½“å‰ç«¯å£çš„è®¾ç½®ï¼š

```sh
system-view
int ge 1/0/1
disp this
disp int ge 1/0/2
disp int ge 1/0/23
disp vlan
disp vlan 10 # or 20
```

é€šè¿‡`Ping`æ¥éªŒè¯å„ä¸ªä¸»æœºä¹‹é—´çš„è¿é€šæ€§ï¼š

```sh
# From PC1
ping 192.168.1.1 # å¯é€š
ping 192.168.1.2 # å¯é€š
ping 192.168.1.3 # ä¸é€š
ping 192.168.1.3 # ä¸é€š
```

## Hybridé“¾è·¯ï¼šVLANé—´çš„é€šä¿¡

![ç½‘ç»œæ‹“æ‰‘](https://lightyears1998.github.io/gzhu-networking-course-record/images/task4-2.png)

æ­å»ºæ‹“æ‰‘ä¹‹åï¼Œé™¤äº†é…ç½®ä¸»æœºçš„é™æ€IPåœ°å€ï¼Œè¿˜éœ€è¦å¯¹äº¤æ¢æœºSWAè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š

```sh
# SWA
vlan 10
port ge 1/0/1

vlan 20
port ge 1/0/2

vlan 30
port ge 1/0/3

int ge 1/0/1
port link-type hybrid
port hybrid vlan 10 30 untagged

int ge 1/0/2
port link-type hybrid
port hybrid vlan 20 30 untagged

int ge 1/0/3
port link-type hybrid
port hybrid vlan 10 20 30 untagged
```

é€šè¿‡`ping`æ¥æ£€æŸ¥è¿é€šæ€§ï¼š

```sh
# From PC5
ping 192.168.1.6 # ä¸é€š
ping 192.168.1.7 # å¯é€š

# From PC7
ping 192.168.1.5 # å¯é€š
ping 192.168.1.6 # å¯é€š
```
