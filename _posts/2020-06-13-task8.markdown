---
layout: post
title:  "Task 8: DHCP ä¸ ACL"
date:   2020-06-13 12:00:00 +0800
categories: [router, dhcp, acl]
---

ç»ˆäºè½®åˆ° DHCP å’Œ ACL è¿™ä¿©è·¯ç”±å™¨çš„ç‰¹é•¿å•¦ï¼ŒğŸ¦ŒåŒ—é¹¿è€å¸ˆè¿™æ¬¡è®©æˆ‘ä»¬åš DHCP å’Œ ACLã€‚

![ç½‘ç»œæ‹“æ‰‘](https://lightyears1998.github.io/gzhu-networking-course-record/images/task8.png)

``` shell
# dhcpserver
sys
sysname dhcpserver

acl advanced 3000
rule 0 deny tcp source 192.168.1.0 0.0.0.255 destination 20.1.1.2 0.0.0.0 destination-port eq telnet

int ge 0/0
ip addr 192.168.1.254 24
packet-filter 3000 inbound

int ge 0/1
ip addr 10.1.1.1 24

dhcp enable
dhcp server ip-pool pc
network 192.168.1.0 24
gateway-list 192.168.1.254

ospf
area 0
network 10.1.1.1 0.0.0.0
area 192.168.1.0
network 192.168.1.0 0.0.0.255
```

``` shell
# R1
sys
sysname R1

int ge 0/1
ip addr 10.1.1.2 24

int ge 0/0
ip addr 20.1.1.1 24

ospf
area 0
network 10.1.1.2 0.0.0.0
network 20.1.1.1 0.0.0.0
```

``` shell
# telnetserver
sys
sysname telnetserver

int ge 0/0
ip addr 20.1.1.2 24

ospf
area 0
network 20.1.1.2 0.0.0.0

local-user lightyears class manage
password simple paSSw0rd
service-type telnet

telnet server enable
line vty 0 63
authentication-mode scheme
```

å®Œæˆä¸Šé¢çš„é…ç½®åå°±å¯ä»¥ä½¿ç”¨åœ¨ PC1 ä½¿ç”¨ `ping` å’Œ `telnet` æŒ‡ä»¤æ¥éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®äº†ã€‚

``` shell
# PC1
sys
sysname PC1

int ge 0/0
ip addr dhcp-alloc

[Ctrl + Z]
ping 20.1.1.2
telnet 20.1.1.2
```

å®éªŒè¿˜æ˜¯åŸºç¡€æ€§çš„å®éªŒï¼Œåªæ˜¯ H3C çš„æ‰‹å†Œæœ‰ç‚¹å‘ã€‚

è™½ç„¶æ‰‹å†Œçš„è¯´æ³•æ˜¯è·¯ç”±å™¨çš„ DHCP æœåŠ¡æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œä½† dhcpserver çš„ `dhcp enable` è¿™æ¡æŒ‡ä»¤åœ¨æˆ‘çš„ HCL æ¨¡æ‹Ÿå™¨é‡Œé¢æ˜¯ä¸èƒ½çœç•¥çš„ã€‚ä¸€æ—¦çœç•¥è¿™å¥ enableï¼ŒDHCP æœåŠ¡å°±ä¸ä¼šæ­£å¸¸å·¥ä½œã€‚

é¡ºå¸¦ä¸€æï¼Œå¦‚æœè¿è¡Œ DHCP æœåŠ¡çš„è·¯ç”±å™¨ä¸Šçš„æŸä¸€ä¸ªæ¥å£ä½¿ç”¨äº† DHCP åœ°å€æ± ä¸Šçš„ IPï¼ˆä¾‹å¦‚æœ¬å®éªŒä¸­çš„ dhcpserver çš„ GE 0/0 æ¥å£ï¼‰ï¼Œé‚£ä¹ˆè¿™æ—¶ä¸éœ€è¦ä½¿ç”¨ `fdhcp server forbidden-ip` æŒ‡ä»¤ï¼Œä¹Ÿä¸éœ€è¦åœ¨å¯¹åº”åœ°å€æ± ä¸‹ä½¿ç”¨ `forbidden-ip` æŒ‡ä»¤ï¼šå·²ç»åˆ†é…ç»™è·¯ç”±å™¨æ¥å£çš„ IP åœ°å€ä¸ä¼šåˆ†é…ç»™å…¶ä»– DHCP Clientã€‚
